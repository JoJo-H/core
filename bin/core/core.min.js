var __reflect=this&&this.__reflect||function(t,e,o){t.__class__=e,o?o.push(e):o=[e],t.__types__=t.__types__?o.concat(t.__types__):o},__extends=this&&this.__extends||function(t,e){function o(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);o.prototype=e.prototype,t.prototype=new o},core;!function(t){var e;!function(t){t[t.DRAGON=0]="DRAGON",t[t.DBFAST=1]="DBFAST",t[t.MOVIECLIP=2]="MOVIECLIP",t[t.SEQUNCE_MOVIE=3]="SEQUNCE_MOVIE"}(e=t.MovieType||(t.MovieType={}));var o=function(){function o(){}return o.getEgretFactory=function(){return this._egretFactory||(this._egretFactory=new dragonBones.EgretFactory,this.initClock()),this._egretFactory},o.initClock=function(){this._movieClock||(this._movieClock=new t.MovieClock,this._movieClock.start())},o.create=function(o,n,r){var i,a=o.split("/");a[a.length-1];switch(n){case e.DRAGON:i=new t.DragonMovie,i.isCache=!1,i.setPath(o,r);break;case e.DBFAST:i=new t.DBFaseMovie,i.isCache=!1,i.setPath(o);break;case e.MOVIECLIP:i=new t.MovieClip,i.isCache=!1,i.setPath(o);break;case e.SEQUNCE_MOVIE:break;default:throw new Error("创建动画错误,动画类型:"+n)}return i},o.fast=function(t,o){var n=this.create("assets/animation/fast/"+o,e.DBFAST);return t.actionName=t.actionName&&""!=t.actionName?t.actionName:"1",this.play(n,t),n},o.playAnim=function(t,o,n){var r=this.create("assets/animation/dragonBones/"+o,e.DRAGON,n);return t.actionName=t.actionName&&""!=t.actionName?t.actionName:o,this.play(r,t),r},o.play=function(e,o){var n=o.playTimes?o.playTimes:0;e.play(o.actionName,n),e.touchEnabled=!1,e.once(t.MovieEvent.COMPLETE,function(){o.onComplete&&o.onComplete()},this),e.scaleX=o.scaleX?o.scaleX:1,e.scaleY=o.scaleY?o.scaleY:1,o.container?(o.container.addChild(e),e.x=o.container.width/2+(o.offsetX||0),e.y=o.container.height/2+(o.offsetY||0)):(t.App.stage.addChild(e),e.x=t.App.stage.width/2+(o.offsetX||0),e.y=t.App.stage.height/2+(o.offsetY||0))},o.getFilenameWithoutExt=function(t){var e=t.split("/"),o=e[e.length-1];return e=o.split("."),e[0]},o}();t.BaseFactory=o,__reflect(o.prototype,"core.BaseFactory")}(core||(core={}));var core;!function(t){var e=function(){function t(t){this._args=[],this._listeners=[],this._isFull=!1,this._component=t,t.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this),t.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemovedFromStage,this)}return t.prototype.getArgs=function(){return this._args},t.prototype.setArgs=function(t){this._args=t},Object.defineProperty(t.prototype,"isFull",{get:function(){return this._isFull},enumerable:!0,configurable:!0}),t.prototype.setFull=function(){this._isFull=!0},t.prototype.isType=function(t){return this._type==t},t.prototype.setType=function(t){this._type=t},t.prototype.listener=function(t,e,o){t&&o&&(t.hasEventListener(e)||(this._listeners.push({component:t,func:o,type:e}),t.addEventListener(e,o,this._component)))},t.prototype.clearLiteners=function(){for(;this._listeners.length>0;){var t=this._listeners.shift();t.component.removeEventListener(t.type,t.func,this)}},t.prototype.onAddToStage=function(t){this._component.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this),(e=this._component).onEnter.apply(e,this._args);var e},t.prototype.onRemovedFromStage=function(){this._component.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemovedFromStage,this),this.clearLiteners(),this._component.onExit()},t}();t.ComponentState=e,__reflect(e.prototype,"core.ComponentState")}(core||(core={}));var core;!function(t){var e=function(e){function o(){var t=e.call(this)||this;return t.isCache=!1,t._atLast=!1,t._playName="",t._frameRate=null,t}return __extends(o,e),o.prototype.setPath=function(e){this._dataPath=e,this._texturePath=e.replace("_ske.dbmv","_tex.png"),this._fileName=t.BaseFactory.getFilenameWithoutExt(e).replace("_ske","")},o.prototype.prepareResource=function(){var t=RES.getRes(this._dataPath),e=RES.getRes(this._texturePath);return t&&e?new Promise(function(t,e){t()}):(RES.createGroup(this._fileName,[this._dataPath]),RES.loadGroup(this._fileName))},o.prototype.play=function(t,e){var o=this;void 0===e&&(e=0),e=0==e?-1:e,this.prepareResource().then(function(){o._playName=t,o.getMC().play(t,e)})},o.prototype.gotoAndStop=function(t,e){var o=this;this.prepareResource().then(function(){o.getMC().gotoAndStop(t,e/24)})},o.prototype.gotoAndPlay=function(t,e,o){var n=this;void 0===o&&(o=0),o=0==o?-1:-1==o?0:o,this.prepareResource().then(function(){n.getMC().gotoAndPlay(t,e/24,o)})},o.prototype.getMC=function(){return null==this._mc&&(this._mc=dragonBones.buildMovie(this._fileName),this.addChild(this._mc),this.initEvents()),this._mc&&null!=this._frameRate&&(this._mc.clipTimeScale=this._frameRate/24),this._mc},Object.defineProperty(o.prototype,"frameRate",{get:function(){return this._frameRate},set:function(t){this._frameRate=t,this._mc&&(this._mc.clipTimeScale=this._frameRate/24)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"atLast",{get:function(){return this._atLast},set:function(t){this._atLast=t},enumerable:!0,configurable:!0}),o.prototype.clearEvents=function(){this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoved,this),this._mc&&(this._mc.removeEventListener(dragonBones.MovieEvent.LOOP_COMPLETE,this.onLoopComplete,this),this._mc.removeEventListener(dragonBones.MovieEvent.COMPLETE,this.onComplete,this),this._mc.removeEventListener(dragonBones.MovieEvent.FRAME_EVENT,this.onFrameLabel,this))},o.prototype.initEvents=function(){this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoved,this),this._mc&&(this._mc.addEventListener(dragonBones.MovieEvent.LOOP_COMPLETE,this.onLoopComplete,this),this._mc.addEventListener(dragonBones.MovieEvent.COMPLETE,this.onComplete,this),this._mc.addEventListener(dragonBones.MovieEvent.FRAME_EVENT,this.onFrameLabel,this))},o.prototype.onLoopComplete=function(e){this.dispatchEvent(new t.MovieEvent(t.MovieEvent.LOOP_COMPLETE))},o.prototype.onComplete=function(e){this.dispatchEvent(new t.MovieEvent(t.MovieEvent.COMPLETE)),this.atLast||t.display.removeFromParent(this._mc)},o.prototype.onFrameLabel=function(e){this.dispatchEvent(new t.MovieEvent(t.MovieEvent.FRAME_LABEL,e.name))},o.prototype.onRemoved=function(t){this.dispose()},o.prototype.dispose=function(){this.isCache?this._mc&&this._mc.stop():this._mc&&(this._mc.dispose(),this.clearEvents(),t.display.removeFromParent(this._mc),this._mc=null)},o}(egret.DisplayObjectContainer);t.DBFaseMovie=e,__reflect(e.prototype,"core.DBFaseMovie",["core.IMovie"])}(core||(core={}));var core;!function(t){var e=function(e){function o(){var t=e.call(this)||this;return t.isCache=!1,t._intialized=!1,t._replaceDisplayArr=[],t._initEvent=!1,t._frameRate=null,t}return __extends(o,e),o.prototype.setPath=function(e,o){this._skeletonJson=e+"_anim.json",this._textureImage=e+"_texture.png",this._textureJson=e+"_texture.json",this._dragonBonesName=t.BaseFactory.getFilenameWithoutExt(e),this._fileName=this._dragonBonesName+"_dragonGroup",this._armatureName=o?o:this._dragonBonesName,this._intialized||(this._intialized=!0,this.stage&&this.onAddToStage(),this.hasEventListener(egret.Event.ADDED_TO_STAGE)||this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this),this.hasEventListener(egret.Event.REMOVED_FROM_STAGE)||this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveFromStage,this))},Object.defineProperty(o.prototype,"armature",{get:function(){return this._armatureName},set:function(t){this._armatureName=t},enumerable:!0,configurable:!0}),o.prototype.play=function(t,e){var o=this;this.prepareResource().then(function(){o.getArmture().animation.play(t,e)})},o.prototype.getArmture=function(){if(!this._armature){dragonBones.WorldClock.clock.remove(this._armature);var e=RES.getRes(this._skeletonJson),o=RES.getRes(this._textureJson),n=RES.getRes(this._textureImage);if(t.BaseFactory.getEgretFactory().getDragonBonesData(this._dragonBonesName)||t.BaseFactory.getEgretFactory().parseDragonBonesData(e,this._dragonBonesName),t.BaseFactory.getEgretFactory().getTextureAtlasData(this._dragonBonesName)||t.BaseFactory.getEgretFactory().parseTextureAtlasData(o,n,this._dragonBonesName),this._armature=t.BaseFactory.getEgretFactory().buildArmature(this._armatureName),this._armature.display.x=this._armature.display.y=0,this.addChild(this._armature.display),this._replaceDisplayArr.length){var r=this._replaceDisplayArr.shift();this.replaceDisplay(r.name,r.display)}dragonBones.WorldClock.clock.add(this._armature),this._frameRate&&(this.frameRate=this._frameRate),this.initEvent()}return this._armature},o.prototype.gotoAndStop=function(t,e){},o.prototype.gotoAndPlay=function(t,e,o){},o.prototype.prepareResource=function(){var t=RES.getRes(this._armatureName),e=RES.getRes(this._textureJson),o=RES.getRes(this._textureImage);return t&&e&&o?new Promise(function(t,e){t()}):(RES.createGroup(this._fileName,[this._skeletonJson,this._textureJson,this._textureImage]),RES.loadGroup(this._fileName))},o.prototype.onFrame=function(e){var o=new t.MovieEvent(t.MovieEvent.FRAME_LABEL,e.frameLabel);this.dispatchEvent(o)},o.prototype.onComplete=function(e){this.dispatchEvent(new t.MovieEvent(t.MovieEvent.COMPLETE))},o.prototype.start=function(t){console.log("开始播放动画：",this._fileName+".",this._armatureName)},o.prototype.frameEvent=function(t){console.log("armature 播放到了一个关键帧！ 帧标签为：",t.frameLabel)},o.prototype.onAddToStage=function(){this.initEvent()},o.prototype.initEvent=function(){this._armature&&!this._initEvent&&(this._initEvent=!0,dragonBones.WorldClock.clock.add(this._armature),this._armature.addEventListener(dragonBones.EgretEvent.START,this.start,this),this._armature.addEventListener(dragonBones.EgretEvent.FRAME_EVENT,this.onFrame,this),this._armature.addEventListener(dragonBones.EgretEvent.COMPLETE,this.onComplete,this),this._armature.addEventListener(dragonBones.EgretEvent.LOOP_COMPLETE,this.onComplete,this))},o.prototype.onRemoveFromStage=function(){dragonBones.WorldClock.clock.remove(this._armature),this._armature&&(this._initEvent=!1,this._armature.animation.stop(),this._armature.removeEventListener(dragonBones.EgretEvent.START,this.start,this),this._armature.removeEventListener(dragonBones.EgretEvent.FRAME_EVENT,this.onFrame,this),this._armature.removeEventListener(dragonBones.EgretEvent.COMPLETE,this.onComplete,this),this._armature.removeEventListener(dragonBones.EgretEvent.LOOP_COMPLETE,this.onComplete,this))},Object.defineProperty(o.prototype,"frameRate",{get:function(){return this._frameRate},set:function(t){this._frameRate=t,this._armature&&(this._armature.clock.timeScale=this._frameRate/24)},enumerable:!0,configurable:!0}),o.prototype.dispose=function(){},o.prototype.replaceDisplay=function(t,e){if(this._armature){var o=this._armature.getSlot(t);o.displayIndex=0,o.display=e}},o.prototype.addReplaceDisplayInfo=function(t){this._replaceDisplayArr.push(t)},o.prototype.replaceGlobal=function(t){this._armature&&RES.getRes(t)&&this._armature.replacedTexture(RES.getRes(t))},o.prototype.getSlot=function(t){return this._armature?this._armature.getSlot(t):null},o}(egret.DisplayObjectContainer);t.DragonMovie=e,__reflect(e.prototype,"core.DragonMovie",["core.IMovie"])}(core||(core={}));var core;!function(t){var e=function(e){function o(){var t=e.call(this)||this;return t._atLast=!1,t.isCache=!1,t._frameRate=null,t._hasEvent=!1,t}return __extends(o,e),Object.defineProperty(o.prototype,"atLast",{get:function(){return this._atLast},set:function(t){this._atLast=t},enumerable:!0,configurable:!0}),o.prototype.setPath=function(e){this._dataPath=e,this._texturePath=e.replace(".json",".png"),this._filename=t.BaseFactory.getFilenameWithoutExt(this._dataPath)},o.prototype.prepareResource=function(){var t=RES.getRes(this._dataPath);return t?new Promise(function(t){t()}):(RES.createGroup(this._filename,[this._dataPath]),RES.loadGroup(this._filename))},o.prototype.play=function(t,e){var o=this;void 0===e&&(e=0),this.prepareResource().then(function(){o.getMC(t).play(e)})},o.prototype.gotoAndStop=function(t,e){var o=this;this.prepareResource().then(function(){o.getMC(t).gotoAndStop(e)})},o.prototype.gotoAndPlay=function(t,e,o){var n=this;void 0===o&&(o=0),this.prepareResource().then(function(){n.getMC(t).gotoAndPlay(e,o)})},o.prototype.getMC=function(t){if(this._mc)return this._hasEvent||this.initEvents(),this._mc;var e=RES.getRes(this._dataPath);return e&&(this._mc=new egret.MovieClip(e.generateMovieClipData(t)),this.initEvents(),this.addChild(this._mc)),this._mc},Object.defineProperty(o.prototype,"frameRate",{get:function(){return this._frameRate},set:function(t){this._frameRate=t,this._mc&&(this._mc.frameRate=t)},enumerable:!0,configurable:!0}),o.prototype.clearEvents=function(){this._hasEvent=!1,this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoved,this),this._mc&&(this._mc.removeEventListener(egret.MovieClipEvent.LOOP_COMPLETE,this.onLoopComplete,this),this._mc.removeEventListener(egret.MovieClipEvent.COMPLETE,this.onComplete,this),this._mc.removeEventListener(egret.MovieClipEvent.FRAME_LABEL,this.onFrameLabel,this))},o.prototype.initEvents=function(){this._hasEvent=!0,this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoved,this),this._mc&&(this._mc.addEventListener(egret.MovieClipEvent.LOOP_COMPLETE,this.onLoopComplete,this),this._mc.addEventListener(egret.MovieClipEvent.COMPLETE,this.onComplete,this),this._mc.addEventListener(egret.MovieClipEvent.FRAME_LABEL,this.onFrameLabel,this))},o.prototype.onLoopComplete=function(e){this.dispatchEvent(new t.MovieEvent(t.MovieEvent.LOOP_COMPLETE))},o.prototype.onComplete=function(e){this.dispatchEvent(new t.MovieEvent(t.MovieEvent.COMPLETE)),this.atLast||t.display.removeFromParent(this)},o.prototype.onFrameLabel=function(e){this.dispatchEvent(new t.MovieEvent(t.MovieEvent.FRAME_LABEL,e.frameLabel))},o.prototype.onRemoved=function(t){this.dispose()},o.prototype.dispose=function(){this.clearEvents()},o}(egret.DisplayObjectContainer);t.MovieClip=e,__reflect(e.prototype,"core.MovieClip",["core.IMovie"])}(core||(core={}));var core;!function(t){var e=function(){function t(){this._lastTime=0}return t.prototype.start=function(){this._lastTime=egret.getTimer(),egret.startTick(this.tick,this)},t.prototype.tick=function(t){var e=t-this._lastTime;return this._lastTime=t,dragonBones.WorldClock.clock.advanceTime(e/1e3),!1},t.prototype.stop=function(){egret.stopTick(this.tick,this)},t}();t.MovieClock=e,__reflect(e.prototype,"core.MovieClock")}(core||(core={}));var core;!function(t){var e=function(t){function e(e,o){void 0===o&&(o=null);var n=t.call(this,e)||this;return n._frameLabel=o,n}return __extends(e,t),Object.defineProperty(e.prototype,"frameLabel",{get:function(){return this._frameLabel},enumerable:!0,configurable:!0}),e.FRAME_LABEL="Frame_Label",e.LOOP_COMPLETE="Loop_Complete",e.COMPLETE="Complete",e}(egret.Event);t.MovieEvent=e,__reflect(e.prototype,"core.MovieEvent")}(core||(core={}));var core;!function(t){var e=function(){function t(){if(this._cacheData=null,this._instance=null,this.instance)throw Error("ProxyCache singleton already constructed!");this._instance=this,this._cacheData={}}return Object.defineProperty(t.prototype,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!0,configurable:!0}),t.prototype.getCache=function(t,e){if(void 0===t&&(t=null),void 0===e&&(e=null),null==t)return this._cacheData;if(this.isCache(t,e)){var o=this.formatParmas(t,e);return this._cacheData[o[0]][o[1]]}return null},t.prototype.formatParmas=function(t,e){if(void 0===e&&(e=null),null==e){var o=t.split(".");t=o[0],e=o[1]}return[t,e]},t.prototype.isCache=function(t,e){void 0===e&&(e=null);var o=this.formatParmas(t,e);return this._cacheData.hasOwnProperty(o[0])&&this._cacheData[o[0]].hasOwnProperty(o[1])},t}();__reflect(e.prototype,"ProxyCache")}(core||(core={}));var core;!function(t){var e=function(){function e(){}return e.getModDo=function(e){return t.is.string(e)?e:e&&e.moddo?e.moddo:null},e.BeforeChange=function(t){return"BeforeChange."+e.getModDo(t)},e.AfterChange=function(t){return"AfterChange."+e.getModDo(t)},e.Change=function(t){return"Change."+e.getModDo(t)},e.Cache=function(t){return"Cache."+e.getModDo(t)},e.CacheChange="CacheChange",e}();t.NotificationKey=e,__reflect(e.prototype,"core.NotificationKey"),t.k=e}(core||(core={}));var core;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(egret.Event.ADDED_TO_STAGE,e.add,e),e}return __extends(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},set:function(t){this._name=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return"true"==this._value||"false"==this._value?"true"==this._value:this._value},set:function(t){this._value=t,this.onUpdate()},enumerable:!0,configurable:!0}),e.prototype.onUpdate=function(){if(this.parent&&this.parent.updateAttribute){var t=this.parent;t.updateAttribute(this)}},e.prototype.add=function(){this.onUpdate()},e}(eui.Component);t.Attribute=e,__reflect(e.prototype,"core.Attribute")}(core||(core={}));var core;!function(t){var e=function(e){function o(){for(var o=[],n=0;n<arguments.length;n++)o[n]=arguments[n];var r=e.call(this)||this;return r._dataMapArr=[],r._args=[],r.$_state=new t.ComponentState(r),r.setArgs(o),r}return __extends(o,e),o.prototype.listener=function(t,e,o){this.$_state.listener(t,e,o)},o.prototype.clearListeners=function(){this.$_state.clearLiteners()},Object.defineProperty(o.prototype,"hook",{get:function(){return this._hook||(this._hook=new t.ComponentHook(this)),this._hook},set:function(t){this._hook=t},enumerable:!0,configurable:!0}),o.prototype.addOperate=function(t){return this.hook.addOperate(t),this},o.prototype.removeOperate=function(t){this.hook.removeOperate(t)},o.prototype.clearOperate=function(){this.hook.clearOperate()},o.prototype.removeOperateByName=function(t){this.hook.removeOperateByName(t)},o.prototype.getOperateByName=function(t){return this.hook.getOperateByName(t)},o.prototype.getArgs=function(){return this.$_state.getArgs()},o.prototype.setArgs=function(t){this.$_state.setArgs(t)},o.prototype.updateAttribute=function(t){this[t.name]=t.value},Object.defineProperty(o.prototype,"data",{get:function(){return this._data},set:function(t){this._data=t,null!=t&&(this.addDataMap("data"),eui.PropertyEvent.dispatchPropertyEvent(this,eui.PropertyEvent.PROPERTY_CHANGE,"data")),this.dataChanged()},enumerable:!0,configurable:!0}),o.prototype.addDataMap=function(t){-1==this._dataMapArr.indexOf(t)&&this._dataMapArr.push(t)},Object.defineProperty(o.prototype,"isFull",{get:function(){return this.$_state.isFull},enumerable:!0,configurable:!0}),o.prototype.setFull=function(){return this.$_state.setFull(),this},o.prototype.setData=function(t,e){return void 0===e&&(e="data"),"data"==e?this.data=t:(this[e]=t,null!=t&&(this.addDataMap(e),eui.PropertyEvent.dispatchPropertyEvent(this,eui.PropertyEvent.PROPERTY_CHANGE,e))),this._hook&&null!=t&&this._hook.setData(t,e),this},o.prototype.dataChanged=function(){},o.prototype.setState=function(t){return this.currentState=t,this},o.prototype.setCompName=function(t){return this.componentName=t,this},Object.defineProperty(o.prototype,"componentName",{get:function(){return this._componentName},set:function(t){this._componentName=t},enumerable:!0,configurable:!0}),o.prototype.isType=function(t){return this.$_state.isType(t)},o.prototype.setType=function(t){this.$_state.setType(t)},o.prototype.onAddToStage=function(t){this.onEnter()},o.prototype.onRemoveFromStage=function(t){this.onExit()},o.prototype.onEnter=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];(o=this.hook).onEnter.apply(o,t);var o},o.prototype.onExit=function(){this.hook.onExit(),this.destoryData()},o.prototype.destoryData=function(){for(;this._dataMapArr.length;)this[this._dataMapArr.shift()]=null;this._args=[],this._data=null,this.componentName=""},o}(eui.Component);t.BaseComponent=e,__reflect(e.prototype,"core.BaseComponent",["core.IComponent"])}(core||(core={}));var core;!function(t){var e=function(){function t(t){this._operates=[],this._component=t}return t.prototype.setData=function(t,e){},t.prototype.onEnter=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var o=0;o<this._operates.length;o++)this._operates[o].enter(this._component)},t.prototype.onExit=function(){for(var t=0;t<this._operates.length;t++)this._operates[t].exit(this._component)},t.prototype.addOperate=function(t){this._operates.push(t)},t.prototype.removeOperate=function(t){var e=this._operates.indexOf(t);e>-1&&(t.exit(this._component),this._operates.splice(e,1))},t.prototype.clearOperate=function(){for(;this._operates.length>0;)this.removeOperate(this._operates[0])},t.prototype.removeOperateByName=function(t){for(var e=this._operates.length-1;e>=0;e--)this._operates[e].getName()==t&&this.removeOperate(this._operates[e])},t.prototype.getOperateByName=function(t){for(var e=[],o=0;o<this._operates.length;o++)this._operates[o].getName()==t&&e.push(this._operates[o]);return e},t.prototype.getOperateByType=function(t){for(var e=[],o=0;o<this._operates.length;o++)this._operates[o].type==t&&e.push(this._operates[o]);return e},t}();t.ComponentHook=e,__reflect(e.prototype,"core.ComponentHook",["core.IComponentHook"])}(core||(core={}));var core;!function(t){var e=function(){function t(){}return t.setStage=function(t){this._stage=t},Object.defineProperty(t,"stage",{get:function(){return this._stage},enumerable:!0,configurable:!0}),t}();t.App=e,__reflect(e.prototype,"core.App")}(core||(core={}));var core;!function(t){var e;!function(t){t[t.SCENE=0]="SCENE",t[t.COMMON=1]="COMMON",t[t.PANEL=2]="PANEL",t[t.MENU=3]="MENU",t[t.BOX=4]="BOX",t[t.GUIDE=5]="GUIDE",t[t.TOOLTIP=6]="TOOLTIP"}(e=t.UIType||(t.UIType={}));var o=function(o){function n(){var t=o.call(this)||this;return t.touchEnabled=!1,t._scene=new eui.UILayer,t._scene.touchEnabled=!1,t.addChild(t._scene),t._common=new eui.UILayer,t._common.touchEnabled=!1,t.addChild(t._common),t._panel=new eui.UILayer,t.addChild(t._panel),t._panel.touchEnabled=!1,t._menu=new eui.UILayer,t.addChild(t._menu),t._menu.touchEnabled=!1,t._box=new eui.UILayer,t.addChild(t._box),t._box.touchEnabled=!1,t._guide=new eui.UILayer,t.addChild(t._guide),t._guide.touchEnabled=!1,t._tooltip=new eui.UILayer,t.addChild(t._tooltip),t._tooltip.touchEnabled=!1,t._containerArr=[t._scene,t._common,t._panel,t._menu,t._box,t._guide,t._tooltip],t}return __extends(n,o),n.prototype.setRoot=function(t){t&&t.addChild(this)},n.prototype.setMenu=function(o){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];null!=this._menuInst&&this.remove(this._menuInst);var i=this.getTypeInst(o,n,e.MENU);t.display.setFullDisplay(i),this._menuInst=i,this._menuInst.bottom=0,this._menuInst.horizontalCenter=0,this._menu.addChild(this._menuInst)},n.prototype.runScene=function(t){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];this._sceneInst&&this.remove(this._sceneInst);var n=this.addScene(t,e);return n},n.prototype.addScene=function(o){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i=this.getTypeInst(o,n,e.SCENE);return t.display.setFullDisplay(i),this._sceneInst=i,this._scene.addChild(i),i},n.prototype.addBox=function(o){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i=this.getTypeInst(o,n,e.BOX);return t.display.setFullDisplay(i),this._box.addChild(i),i},n.prototype.addPanel=function(o){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i=this.getTypeInst(o,n,e.PANEL);return t.display.setFullDisplay(i),this._panel.addChild(i),i},n.prototype.addCommon=function(o){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i=this.getTypeInst(o,n,e.COMMON);return t.display.setFullDisplay(i),this._common.addChild(i),i},n.prototype.addTooltip=function(o){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i=this.getTypeInst(o,n,e.TOOLTIP);return t.display.setFullDisplay(i),this._tooltip.addChild(i),i},n.prototype.getTypeInst=function(e,o,n){var r,i=null;return"string"==typeof e&&(r=e,e=t.BaseComponent),"Function"==e.constructor.name?i=new(e.bind.apply(e,[void 0].concat(o))):(i=e,i.setArgs(o),r&&(i.skinName=r)),i},n.prototype.removeComponent=function(t){var e=this.getComponent(t);egret.is(e,"BaseComponent")&&(this.isSingleContainer(e)||this.remove(e))},n.prototype.getComponent=function(t){for(var e=0;e<this._containerArr.length;e++){var o=this._containerArr[e],n=this.getComponentByName(t,o);if(n)return n}return null},n.prototype.getComponentByName=function(t,e){for(var o=e.numChildren,n=0;o>n;n++){var r=e.getChildAt(n);if(r.componentName==t)return r}return null},n.prototype.isSingleContainer=function(t){return t.isType(e.SCENE)&&t.isType(e.MENU)?!0:!1},n.prototype.getContainerByType=function(t){switch(t){case e.BOX:return this._box;case e.SCENE:return this._scene;case e.GUIDE:return this._guide;case e.COMMON:return this._common;case e.MENU:return this._menu;case e.TOOLTIP:return this._tooltip;case e.PANEL:return this._panel}return null},n.prototype.remove=function(e){e&&t.display.removeFromParent(e)},n}(eui.UILayer);__reflect(o.prototype,"UI")}(core||(core={}));var core;!function(t){var e=function(){function t(e){void 0===e&&(e=null),this.mediatorName=null,this.mediatorName=null!=e?e:t.NAME}return t.prototype.getMediatorName=function(){return this.mediatorName},t.prototype.listNotificationInterests=function(){return[]},t.prototype.handleNotification=function(t){},t.prototype.onRegister=function(){},t.prototype.onRemove=function(){},t.NAME="Mediator",t}();t.Mediator=e,__reflect(e.prototype,"core.Mediator",["core.IMediator"])}(core||(core={}));var core;!function(t){var e=function(t){function e(o,n){void 0===o&&(o=null),void 0===n&&(n=null);var r=t.call(this)||this;return r._proxyName=null,r._data=null,r._proxyName=null!=o?o:e.NAME,null!=n&&r.setData(n),r}return __extends(e,t),e.prototype.getProxyName=function(){return this._proxyName},e.prototype.setData=function(t){this._data=t},e.prototype.getData=function(){return this._data},e.prototype.onRegister=function(){},e.prototype.onRemove=function(){},e.NAME="Proxy",e}(egret.EventDispatcher);t.Model=e,__reflect(e.prototype,"core.Model",["core.IModel"])}(core||(core={}));var core;!function(t){function e(e){t.singleton(m).registerMediator(e)}function o(e){t.singleton(m).retrieveMediator(e)}function n(e){t.singleton(m).hasMediator(e)}function r(e){t.singleton(m).removeMediator(e)}function i(e){t.singleton(m).registerModel(e)}function a(e){t.singleton(m).retrieveModel(e)}function s(e){t.singleton(m).hasModel(e)}function p(e){t.singleton(m).removeModel(e)}function c(e,o,n,r){void 0===r&&(r=0),t.singleton(m).registerObserver(e,new t.Observer(o,n,r))}function u(e,o,n){void 0===o&&(o=null),void 0===n&&(n=null),t.singleton(m).notifyObservers(new t.Notification(e,o,n))}function h(e,o){t.singleton(m).removeObserver(e,o)}function l(e){t.singleton(m).removeObserverByName(e)}function f(e){t.singleton(m).removeObserverByContext(e)}function _(e,o){return t.singleton(m).checkObserver(e,o)}var m=function(){function e(){if(this._observerMap=null,this._mediatorMap=null,this._modelMap=null,this.instance)throw Error("MVCSystem singleton already constructed!");this._instance=this,this._observerMap={},this._mediatorMap={},this._modelMap={}}return Object.defineProperty(e.prototype,"instance",{get:function(){return this._instance||(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.registerMediator=function(e){var o=e.getMediatorName();if(!this._mediatorMap[o]){this._mediatorMap[o]=e;var n=e.listNotificationInterests(),r=n.length;if(r>0)for(var i=new t.Observer(e.handleNotification,e),a=0;r>a;a++)this.registerObserver(n[a],i);e.onRegister()}},e.prototype.retrieveMediator=function(t){return this._mediatorMap[t]||null},e.prototype.removeMediator=function(t){var e=this._mediatorMap[t];if(!e)return null;for(var o=e.listNotificationInterests(),n=o.length;n--;)this.removeObserver(o[n],e);return delete this._mediatorMap[t],e.onRemove(),e},e.prototype.hasMediator=function(t){return null!=this._mediatorMap[t]},e.prototype.registerModel=function(t){var e=t.getProxyName();this._modelMap[e]||(this._modelMap[e]=t,t.onRegister())},e.prototype.removeModel=function(t){var e=this._modelMap[t];return e&&(delete this._modelMap[t],e.onRemove()),e},e.prototype.retrieveModel=function(t){return this._modelMap[t]||null},e.prototype.hasModel=function(t){return null!=this._modelMap[t]},e.prototype.registerObserver=function(t,e){var o=this._observerMap[t];o&&o.length>0?this.checkObserver(t,e.getNotifyContext())?console.warn("registerObserver重复注册:",t):(o.push(e),o.sort(function(t,e){return e.getPriority()-t.getPriority()})):this._observerMap[t]=[e]},e.prototype.checkObserver=function(t,e){for(var o=this._observerMap[t],n=o.length,r=0;n>r;r++){var i=o[r];if(i.compareNotifyContext(e))return!0}return!1},e.prototype.notifyObservers=function(t){var e=t.getName(),o=this._observerMap[e];if(o)for(var n=o.slice(0),r=n.length,i=0;r>i;i++){var a=n[i];a.notifyObserver(t)}},e.prototype.removeObserver=function(t,e){var o=this._observerMap[t];if(o)for(var n=o.length;n--;){var r=o[n];if(r.compareNotifyContext(e)){o.splice(n,1);break}}},e.prototype.removeObserverByName=function(t){this._observerMap[t]=[]},e.prototype.removeObserverByContext=function(t){for(var e in this._observerMap)this.removeObserver(e,t)},e}();__reflect(m.prototype,"MVCSystem"),t.registerMediator=e,t.retrieveMediator=o,t.hasMediator=n,t.removeMediator=r,t.registerModel=i,t.retrieveModel=a,t.hasModel=s,t.removeModel=p,t.addNotification=c,t.sendNotification=u,t.removeNotification=h,t.removeNotificationByName=l,t.removeNotificationByContext=f,t.hasNotification=_}(core||(core={}));var core;!function(t){var e=function(){function t(t,e,o){void 0===e&&(e=null),void 0===o&&(o=null),this.name=null,this.body=null,this.type=null,this.name=t,this.body=e,this.type=o}return t.prototype.getName=function(){return this.name},t.prototype.setBody=function(t){this.body=t},t.prototype.getBody=function(){return this.body},t.prototype.setType=function(t){this.type=t},t.prototype.getType=function(){return this.type},t.prototype.toString=function(){var t="Notification Name: "+this.getName();return t+="\nBody:"+(null==this.getBody()?"null":this.getBody().toString()),t+="\nType:"+(null==this.getType()?"null":this.getType())},t}();t.Notification=e,__reflect(e.prototype,"core.Notification",["core.INotification"])}(core||(core={}));var core;!function(t){var e=function(){function t(t,e,o){void 0===o&&(o=0),this._notifyMethod=null,this._context=null,this._priority=0,this.setNotifyMethod(t),this.setNotifyContext(e),this.setPriority(o)}return t.prototype.getNotifyMethod=function(){return this._notifyMethod},t.prototype.setNotifyMethod=function(t){this._notifyMethod=t},t.prototype.getNotifyContext=function(){return this._context},t.prototype.setNotifyContext=function(t){this._context=t},t.prototype.getPriority=function(){return this._priority},t.prototype.setPriority=function(t){this._priority=t},t.prototype.notifyObserver=function(t){this.getNotifyMethod().call(this._context,t)},t.prototype.compareNotifyContext=function(t){return this._context==t},t}();t.Observer=e,__reflect(e.prototype,"core.Observer",["core.IObserver"])}(core||(core={}));var core;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setName=function(t){this._name=t;var e=this;return e},e.prototype.getName=function(){return this._name},e.prototype.enter=function(t){},e.prototype.exit=function(t){},e}(egret.HashObject);t.BaseOperate=e,__reflect(e.prototype,"core.BaseOperate",["core.IComponentOperate"])}(core||(core={}));var core;!function(t){var e=function(){function e(){}return e.setFullDisplay=function(e){e.width=t.App.stage.stageWidth,e.width=t.App.stage.stageWidth
},e.removeAllChildren=function(t){for(;t.numChildren>0;)t.removeChildAt(0)},e.removeFromParent=function(t){t&&t.parent&&t.parent.removeChild(t)},e.setAnchor=function(t,e,o){void 0===o&&(o=e),t.anchorOffsetX=t.width*e,t.anchorOffsetY=t.height*o},Object.defineProperty(e,"stageW",{get:function(){return t.App.stage.stageWidth},enumerable:!0,configurable:!0}),Object.defineProperty(e,"stageH",{get:function(){return t.App.stage.stageHeight},enumerable:!0,configurable:!0}),e}();t.display=e,__reflect(e.prototype,"core.display")}(core||(core={}));var core;!function(t){var e=function(){function t(){}return t.truthy=function(t){return this.existy(t)&&t!==!1&&!this.nan(t)&&""!==t&&0!==t},t.falsy=function(t){return!this.truthy(t)},t.existy=function(t){return null!==t&&void 0!==t},t.undefined=function(t){return void 0===t},t.nan=function(t){return t!==t},t.nul=function(t){return null===t},t.number=function(e){return!this.nan(e)&&"[object Number]"===t.toString.call(e)},t.object=function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},t.fun=function(e){return"[object Function]"===t.toString.call(e)||"function"==typeof e},t.array=function(e){return Array.isArray(e)||"[object Array]"===t.toString.call(e)},t.bool=function(e){return e===!0||e===!1||"[object Boolean]"===t.toString.call(e)},t.date=function(e){return"[object Date]"===t.toString.call(e)},t.regexp=function(e){return"[object RegExp]"===t.toString.call(e)},t.string=function(e){return"[object String]"===t.toString.call(e)},t["char"]=function(t){return this.string(t)&&1===t.length},t.even=function(t){return this.number(t)&&t%2===0},t.odd=function(t){return this.number(t)&&t%2===1},t.decimal=function(t){return this.number(t)&&t%1!==0},t.integer=function(t){return this.number(t)&&t%1===0},t.toString=Object.prototype.toString,t}();t.is=e,__reflect(e.prototype,"core.is")}(core||(core={}));var core;!function(t){var e=function(){function e(t){this._leftArr=[],this._useArr=[],this._type=t}return e.prototype.push=function(e){var o=this._useArr.indexOf(e);if(-1!=o){var n=this._useArr[o];t.is.fun(n.dispose)&&n.dispose(),this._useArr.splice(o,1)}-1==this._leftArr.indexOf(e)&&this._leftArr.push(e)},e.prototype.pop=function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];if(0==this._leftArr.length){var n=new this._type;this._leftArr.push(n)}var r=this._leftArr.shift();return t.is.fun(r.init)&&r.init.apply(r,e),this._useArr.push(r),r},e}();__reflect(e.prototype,"ObjectPool");var o=function(){function t(){}return t.getPool=function(t){var o=t.name,n=Symbol["for"](o);return this._poolMap.has(n)||this._poolMap.set(n,new e(t)),this._poolMap.get(n)},t.getTypePool=function(t,o){var n=o+t.name,r=Symbol["for"](n);return this._poolMap.has(r)||this._poolMap.set(r,new e(t)),this._poolMap.get(r)},t._poolMap=new Map,t}();__reflect(o.prototype,"pool")}(core||(core={}));var core;!function(t){function e(t){var e=t.name,o=Symbol["for"](e);return this._singletonMap.hasOwnProperty(o)||(this._singletonMap[o]=new t),this._singletonMap[o]}function o(t,e){var o=e+t.name,n=Symbol["for"](o);return this._singletonMap.hasOwnProperty(n)||(this._singletonMap[n]=new e),this._singletonMap[n]}t.singleton=e,t.typeSingleton=o}(core||(core={}));var core;!function(t){function e(t){return t.hasOwnProperty(this._type_key_name)||(t[this._type_key_name]=this._type_id_++),t[this._type_key_name]}function o(t){return t&&t.hasOwnProperty(this._type_key_name)}t.getTypeId=e,t.hasTypeId=o}(core||(core={}));